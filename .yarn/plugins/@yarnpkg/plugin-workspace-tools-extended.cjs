/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-workspace-tools-extended",
factory: function (require) {
var plugin=(()=>{var ie=Object.create,O=Object.defineProperty;var ae=Object.getOwnPropertyDescriptor;var ne=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty;var ce=i=>O(i,"__esModule",{value:!0});var h=i=>{if(typeof require!="undefined")return require(i);throw new Error('Dynamic require of "'+i+'" is not supported')};var u=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),Ee=(i,e)=>{for(var r in e)O(i,r,{get:e[r],enumerable:!0})},pe=(i,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ne(e))!le.call(i,a)&&a!=="default"&&O(i,a,{get:()=>e[a],enumerable:!(r=ae(e,a))||r.enumerable});return i},p=i=>pe(ce(O(i!=null?ie(oe(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var $=u((Ue,U)=>{var he="2.0.0",Ie=256,ue=Number.MAX_SAFE_INTEGER||9007199254740991,me=16;U.exports={SEMVER_SPEC_VERSION:he,MAX_LENGTH:Ie,MAX_SAFE_INTEGER:ue,MAX_SAFE_COMPONENT_LENGTH:me}});var S=u((ve,v)=>{var fe=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...i)=>console.error("SEMVER",...i):()=>{};v.exports=fe});var D=u((I,M)=>{var{MAX_SAFE_COMPONENT_LENGTH:k}=$(),Re=S();I=M.exports={};var de=I.re=[],t=I.src=[],s=I.t={},Ne=0,n=(i,e,r)=>{let a=Ne++;Re(a,e),s[i]=a,t[a]=e,de[a]=new RegExp(e,r?"g":void 0)};n("NUMERICIDENTIFIER","0|[1-9]\\d*");n("NUMERICIDENTIFIERLOOSE","[0-9]+");n("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");n("MAINVERSION",`(${t[s.NUMERICIDENTIFIER]})\\.(${t[s.NUMERICIDENTIFIER]})\\.(${t[s.NUMERICIDENTIFIER]})`);n("MAINVERSIONLOOSE",`(${t[s.NUMERICIDENTIFIERLOOSE]})\\.(${t[s.NUMERICIDENTIFIERLOOSE]})\\.(${t[s.NUMERICIDENTIFIERLOOSE]})`);n("PRERELEASEIDENTIFIER",`(?:${t[s.NUMERICIDENTIFIER]}|${t[s.NONNUMERICIDENTIFIER]})`);n("PRERELEASEIDENTIFIERLOOSE",`(?:${t[s.NUMERICIDENTIFIERLOOSE]}|${t[s.NONNUMERICIDENTIFIER]})`);n("PRERELEASE",`(?:-(${t[s.PRERELEASEIDENTIFIER]}(?:\\.${t[s.PRERELEASEIDENTIFIER]})*))`);n("PRERELEASELOOSE",`(?:-?(${t[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${t[s.PRERELEASEIDENTIFIERLOOSE]})*))`);n("BUILDIDENTIFIER","[0-9A-Za-z-]+");n("BUILD",`(?:\\+(${t[s.BUILDIDENTIFIER]}(?:\\.${t[s.BUILDIDENTIFIER]})*))`);n("FULLPLAIN",`v?${t[s.MAINVERSION]}${t[s.PRERELEASE]}?${t[s.BUILD]}?`);n("FULL",`^${t[s.FULLPLAIN]}$`);n("LOOSEPLAIN",`[v=\\s]*${t[s.MAINVERSIONLOOSE]}${t[s.PRERELEASELOOSE]}?${t[s.BUILD]}?`);n("LOOSE",`^${t[s.LOOSEPLAIN]}$`);n("GTLT","((?:<|>)?=?)");n("XRANGEIDENTIFIERLOOSE",`${t[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);n("XRANGEIDENTIFIER",`${t[s.NUMERICIDENTIFIER]}|x|X|\\*`);n("XRANGEPLAIN",`[v=\\s]*(${t[s.XRANGEIDENTIFIER]})(?:\\.(${t[s.XRANGEIDENTIFIER]})(?:\\.(${t[s.XRANGEIDENTIFIER]})(?:${t[s.PRERELEASE]})?${t[s.BUILD]}?)?)?`);n("XRANGEPLAINLOOSE",`[v=\\s]*(${t[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${t[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${t[s.XRANGEIDENTIFIERLOOSE]})(?:${t[s.PRERELEASELOOSE]})?${t[s.BUILD]}?)?)?`);n("XRANGE",`^${t[s.GTLT]}\\s*${t[s.XRANGEPLAIN]}$`);n("XRANGELOOSE",`^${t[s.GTLT]}\\s*${t[s.XRANGEPLAINLOOSE]}$`);n("COERCE",`(^|[^\\d])(\\d{1,${k}})(?:\\.(\\d{1,${k}}))?(?:\\.(\\d{1,${k}}))?(?:$|[^\\d])`);n("COERCERTL",t[s.COERCE],!0);n("LONETILDE","(?:~>?)");n("TILDETRIM",`(\\s*)${t[s.LONETILDE]}\\s+`,!0);I.tildeTrimReplace="$1~";n("TILDE",`^${t[s.LONETILDE]}${t[s.XRANGEPLAIN]}$`);n("TILDELOOSE",`^${t[s.LONETILDE]}${t[s.XRANGEPLAINLOOSE]}$`);n("LONECARET","(?:\\^)");n("CARETTRIM",`(\\s*)${t[s.LONECARET]}\\s+`,!0);I.caretTrimReplace="$1^";n("CARET",`^${t[s.LONECARET]}${t[s.XRANGEPLAIN]}$`);n("CARETLOOSE",`^${t[s.LONECARET]}${t[s.XRANGEPLAINLOOSE]}$`);n("COMPARATORLOOSE",`^${t[s.GTLT]}\\s*(${t[s.LOOSEPLAIN]})$|^$`);n("COMPARATOR",`^${t[s.GTLT]}\\s*(${t[s.FULLPLAIN]})$|^$`);n("COMPARATORTRIM",`(\\s*)${t[s.GTLT]}\\s*(${t[s.LOOSEPLAIN]}|${t[s.XRANGEPLAIN]})`,!0);I.comparatorTrimReplace="$1$2$3";n("HYPHENRANGE",`^\\s*(${t[s.XRANGEPLAIN]})\\s+-\\s+(${t[s.XRANGEPLAIN]})\\s*$`);n("HYPHENRANGELOOSE",`^\\s*(${t[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${t[s.XRANGEPLAINLOOSE]})\\s*$`);n("STAR","(<|>)?=?\\s*\\*");n("GTE0","^\\s*>=\\s*0.0.0\\s*$");n("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")});var G=u((Me,x)=>{var ge=["includePrerelease","loose","rtl"],Le=i=>i?typeof i!="object"?{loose:!0}:ge.filter(e=>i[e]).reduce((e,r)=>(e[r]=!0,e),{}):{};x.exports=Le});var q=u((xe,B)=>{var X=/^[0-9]+$/,j=(i,e)=>{let r=X.test(i),a=X.test(e);return r&&a&&(i=+i,e=+e),i===e?0:r&&!a?-1:a&&!r?1:i<e?-1:1},Oe=(i,e)=>j(e,i);B.exports={compareIdentifiers:j,rcompareIdentifiers:Oe}});var z=u((Xe,V)=>{var A=S(),{MAX_LENGTH:_,MAX_SAFE_INTEGER:T}=$(),{re:H,t:W}=D(),$e=G(),{compareIdentifiers:N}=q(),c=class{constructor(e,r){if(r=$e(r),e instanceof c){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>_)throw new TypeError(`version is longer than ${_} characters`);A("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let a=e.trim().match(r.loose?H[W.LOOSE]:H[W.FULL]);if(!a)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>T||this.major<0)throw new TypeError("Invalid major version");if(this.minor>T||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>T||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let l=+o;if(l>=0&&l<T)return l}return o}):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(A("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if(typeof e=="string"&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),N(this.major,e.major)||N(this.minor,e.minor)||N(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let a=this.prerelease[r],o=e.prerelease[r];if(A("prerelease compare",r,a,o),a===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(a===void 0)return-1;if(a===o)continue;return N(a,o)}while(++r)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let r=0;do{let a=this.build[r],o=e.build[r];if(A("prerelease compare",r,a,o),a===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(a===void 0)return-1;if(a===o)continue;return N(a,o)}while(++r)}inc(e,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r),this.inc("pre",r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r),this.inc("pre",r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);a===-1&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};V.exports=c});var Q=u((je,K)=>{var{MAX_LENGTH:Ae}=$(),{re:Z,t:Y}=D(),J=z(),Te=G(),we=(i,e)=>{if(e=Te(e),i instanceof J)return i;if(typeof i!="string"||i.length>Ae||!(e.loose?Z[Y.LOOSE]:Z[Y.FULL]).test(i))return null;try{return new J(i,e)}catch(a){return null}};K.exports=we});var Ge={};Ee(Ge,{default:()=>De});var w=p(h("@yarnpkg/cli")),m=p(h("@yarnpkg/core")),E=p(h("clipanion"));function f(i=[]){let e=i.filter(r=>typeof r=="string");return console.info(e.join(" ")),e}var ee=p(Q()),ye=(i=[])=>f(["npm","publish",...i]),g=class extends w.BaseCommand{constructor(){super(...arguments);this.tag=E.Option.String("--tag",null,{description:"The tag on the registry that the package should be attached to. '-C,--canary' will overwrite this parameter."});this.noTag=E.Option.Boolean("--no-tag",!1,{description:"Force a stable release regardless of version string."});this.tolerateRepublish=E.Option.Boolean("--tolerate-republish",!1,{description:"Warn and exit when republishing an already existing version of a package."});this.canary=E.Option.Boolean("-C,--canary",!1,{description:"Tag the release as 'canary'. The standard pre-release tag for @FuelRats projects."});this.all=E.Option.Boolean("-A,--all",!1,{description:"Publish all public repositories in the current project."});this.workspaces=E.Option.Rest()}async execute(){let e=await m.Configuration.find(this.context.cwd,this.context.plugins),{project:r,workspace:a}=await m.Project.find(e,this.context.cwd),o;if(this.all)o=r.workspaces.reduce((l,d)=>(d.manifest.private||l.push(d),l),[]);else if(this.workspaces.length>0){if(!a)throw new w.WorkspaceRequiredError(r.cwd,this.context.cwd);o=this.workspaces.map(l=>{let d=m.structUtils.parseIdent(l),b=r.getWorkspaceByIdent(d);if(b.manifest.private)throw new E.UsageError(`Workspace ${m.structUtils.prettyIdent(e,d)} is private and cannot be published. Aborting...`);return b})}if(!o||o.length===0)throw new E.UsageError("No list of workspaces were provided. Please supply at least one valid package name or '-A,--all'");for(let l of o)await this.cli.run(ye([this.getTagArg(l),this.tolerateRepublishArg]),{cwd:l.cwd})}getTagArg(e){var a;if(this.noTag)return null;let r=null;if(this.canary)r="canary";else if(this.tag)r=this.tag;else{let o=(0,ee.default)(e.manifest.version,{includePrerelease:!0}),l=(a=o==null?void 0:o.prerelease)==null?void 0:a[0];typeof l=="string"&&(r=l)}return r?`--tag=${r}`:null}get tolerateRepublishArg(){return this.tolerateRepublish?"--tolerate-republish":null}};g.paths=[["workspaces","release"]],g.usage=E.Command.Usage({category:"Workspace-related commands",description:"Publish a list of workspaces in the project.",details:`
      This command will publish a list of packages, or optionally, all packages of a workspace.

      If a pre-release tag is detected for the package version, the package will be published under that tag instead of 'latest'.
    `});var re=g;var C=p(h("@yarnpkg/cli")),P=p(h("@yarnpkg/core")),R=p(h("clipanion"));var y=p(h("@yarnpkg/core")),te=p(h("clipanion"));function F(i,e){e.forEach(r=>{let a=`@yarnpkg/plugin-${r}`;if(!i.plugins.has(a)){let o=y.structUtils.prettyIdent(i,y.structUtils.parseIdent(a)),l=y.structUtils.prettyReference(i,`yarn plugin import ${r}`);throw new te.UsageError(`${o} is a required plugin. Please import it by using '${l}'`)}})}var Ce=(i=[])=>f(["version","apply","--all",...i]),Pe=(i=[])=>f(["version","--deferred",...i]),Se=(i=[])=>f(["workspaces","foreach",...i]),L=class extends C.BaseCommand{constructor(){super(...arguments);this.tag=R.Option.String("--tag",null,{description:"Tag the release with the given tag. '-C,--canary' will overwrite this parameter."});this.canary=R.Option.Boolean("-C,--canary",!1,{description:"Tag the release as 'canary'. The standard pre-release tag for @FuelRats projects."});this.strategy=R.Option.Proxy({required:1})}async execute(){let e=await P.Configuration.find(this.context.cwd,this.context.plugins);F(e,["workspace-tools","version"]);let{project:r,workspace:a}=await P.Project.find(e,this.context.cwd);if(!a)throw new C.WorkspaceRequiredError(r.cwd,this.context.cwd);let o=Pe([this.strategy[0]]);await this.cli.run(Se(o)),await this.cli.run(o),await this.cli.run(Ce([this.tagArg]))}get tagArg(){return this.canary?"--prerelease=canary.%n":this.tag?`--prerelease=${this.tag}.%n`:null}};L.paths=[["workspaces","version"]],L.usage=R.Command.Usage({category:"Workspace-related commands",description:"Update the project-wide fixed semver.",details:`
      This command will bump the version number of all workspaces in the project, then the project package itself.

      Use the \`-C,--canary\` flag to set the version to a canary release.
    `,examples:[["Bump the minor semver project-wide","yarn workspaces version minor"],["Bump the project-wide semver to a new minor-ver pre-release","yarn workspaces version minor --canary"]]});var se=L;var ke={commands:[se,re]},De=ke;return Ge;})();
return plugin;
}
};
