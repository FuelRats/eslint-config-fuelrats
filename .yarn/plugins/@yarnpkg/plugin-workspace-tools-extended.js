/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-workspace-tools-extended",
factory: function (require) {
var plugin=(()=>{var ae=Object.create,O=Object.defineProperty;var oe=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var le=Object.getPrototypeOf,pe=Object.prototype.hasOwnProperty;var Ee=i=>O(i,"__esModule",{value:!0});var h=i=>{if(typeof require!="undefined")return require(i);throw new Error('Dynamic require of "'+i+'" is not supported')};var u=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),he=(i,e)=>{for(var r in e)O(i,r,{get:e[r],enumerable:!0})},Ie=(i,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ce(e))!pe.call(i,n)&&n!=="default"&&O(i,n,{get:()=>e[n],enumerable:!(r=oe(e,n))||r.enumerable});return i},E=i=>Ie(Ee(O(i!=null?ae(le(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var A=u((Me,U)=>{var ue="2.0.0",me=256,fe=Number.MAX_SAFE_INTEGER||9007199254740991,de=16;U.exports={SEMVER_SPEC_VERSION:ue,MAX_LENGTH:me,MAX_SAFE_INTEGER:fe,MAX_SAFE_COMPONENT_LENGTH:de}});var y=u((xe,M)=>{var Ne=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...i)=>console.error("SEMVER",...i):()=>{};M.exports=Ne});var D=u((I,x)=>{var{MAX_SAFE_COMPONENT_LENGTH:S}=A(),Re=y();I=x.exports={};var ge=I.re=[],t=I.src=[],s=I.t={},Le=0,a=(i,e,r)=>{let n=Le++;Re(n,e),s[i]=n,t[n]=e,ge[n]=new RegExp(e,r?"g":void 0)};a("NUMERICIDENTIFIER","0|[1-9]\\d*");a("NUMERICIDENTIFIERLOOSE","[0-9]+");a("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");a("MAINVERSION",`(${t[s.NUMERICIDENTIFIER]})\\.(${t[s.NUMERICIDENTIFIER]})\\.(${t[s.NUMERICIDENTIFIER]})`);a("MAINVERSIONLOOSE",`(${t[s.NUMERICIDENTIFIERLOOSE]})\\.(${t[s.NUMERICIDENTIFIERLOOSE]})\\.(${t[s.NUMERICIDENTIFIERLOOSE]})`);a("PRERELEASEIDENTIFIER",`(?:${t[s.NUMERICIDENTIFIER]}|${t[s.NONNUMERICIDENTIFIER]})`);a("PRERELEASEIDENTIFIERLOOSE",`(?:${t[s.NUMERICIDENTIFIERLOOSE]}|${t[s.NONNUMERICIDENTIFIER]})`);a("PRERELEASE",`(?:-(${t[s.PRERELEASEIDENTIFIER]}(?:\\.${t[s.PRERELEASEIDENTIFIER]})*))`);a("PRERELEASELOOSE",`(?:-?(${t[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${t[s.PRERELEASEIDENTIFIERLOOSE]})*))`);a("BUILDIDENTIFIER","[0-9A-Za-z-]+");a("BUILD",`(?:\\+(${t[s.BUILDIDENTIFIER]}(?:\\.${t[s.BUILDIDENTIFIER]})*))`);a("FULLPLAIN",`v?${t[s.MAINVERSION]}${t[s.PRERELEASE]}?${t[s.BUILD]}?`);a("FULL",`^${t[s.FULLPLAIN]}$`);a("LOOSEPLAIN",`[v=\\s]*${t[s.MAINVERSIONLOOSE]}${t[s.PRERELEASELOOSE]}?${t[s.BUILD]}?`);a("LOOSE",`^${t[s.LOOSEPLAIN]}$`);a("GTLT","((?:<|>)?=?)");a("XRANGEIDENTIFIERLOOSE",`${t[s.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);a("XRANGEIDENTIFIER",`${t[s.NUMERICIDENTIFIER]}|x|X|\\*`);a("XRANGEPLAIN",`[v=\\s]*(${t[s.XRANGEIDENTIFIER]})(?:\\.(${t[s.XRANGEIDENTIFIER]})(?:\\.(${t[s.XRANGEIDENTIFIER]})(?:${t[s.PRERELEASE]})?${t[s.BUILD]}?)?)?`);a("XRANGEPLAINLOOSE",`[v=\\s]*(${t[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${t[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${t[s.XRANGEIDENTIFIERLOOSE]})(?:${t[s.PRERELEASELOOSE]})?${t[s.BUILD]}?)?)?`);a("XRANGE",`^${t[s.GTLT]}\\s*${t[s.XRANGEPLAIN]}$`);a("XRANGELOOSE",`^${t[s.GTLT]}\\s*${t[s.XRANGEPLAINLOOSE]}$`);a("COERCE",`(^|[^\\d])(\\d{1,${S}})(?:\\.(\\d{1,${S}}))?(?:\\.(\\d{1,${S}}))?(?:$|[^\\d])`);a("COERCERTL",t[s.COERCE],!0);a("LONETILDE","(?:~>?)");a("TILDETRIM",`(\\s*)${t[s.LONETILDE]}\\s+`,!0);I.tildeTrimReplace="$1~";a("TILDE",`^${t[s.LONETILDE]}${t[s.XRANGEPLAIN]}$`);a("TILDELOOSE",`^${t[s.LONETILDE]}${t[s.XRANGEPLAINLOOSE]}$`);a("LONECARET","(?:\\^)");a("CARETTRIM",`(\\s*)${t[s.LONECARET]}\\s+`,!0);I.caretTrimReplace="$1^";a("CARET",`^${t[s.LONECARET]}${t[s.XRANGEPLAIN]}$`);a("CARETLOOSE",`^${t[s.LONECARET]}${t[s.XRANGEPLAINLOOSE]}$`);a("COMPARATORLOOSE",`^${t[s.GTLT]}\\s*(${t[s.LOOSEPLAIN]})$|^$`);a("COMPARATOR",`^${t[s.GTLT]}\\s*(${t[s.FULLPLAIN]})$|^$`);a("COMPARATORTRIM",`(\\s*)${t[s.GTLT]}\\s*(${t[s.LOOSEPLAIN]}|${t[s.XRANGEPLAIN]})`,!0);I.comparatorTrimReplace="$1$2$3";a("HYPHENRANGE",`^\\s*(${t[s.XRANGEPLAIN]})\\s+-\\s+(${t[s.XRANGEPLAIN]})\\s*$`);a("HYPHENRANGELOOSE",`^\\s*(${t[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${t[s.XRANGEPLAINLOOSE]})\\s*$`);a("STAR","(<|>)?=?\\s*\\*");a("GTE0","^\\s*>=\\s*0.0.0\\s*$");a("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")});var G=u((Xe,X)=>{var Oe=["includePrerelease","loose","rtl"],Ae=i=>i?typeof i!="object"?{loose:!0}:Oe.filter(e=>i[e]).reduce((e,r)=>(e[r]=!0,e),{}):{};X.exports=Ae});var H=u((je,q)=>{var j=/^[0-9]+$/,B=(i,e)=>{let r=j.test(i),n=j.test(e);return r&&n&&(i=+i,e=+e),i===e?0:r&&!n?-1:n&&!r?1:i<e?-1:1},$e=(i,e)=>B(e,i);q.exports={compareIdentifiers:B,rcompareIdentifiers:$e}});var Z=u((Be,z)=>{var $=y(),{MAX_LENGTH:_,MAX_SAFE_INTEGER:T}=A(),{re:W,t:V}=D(),Te=G(),{compareIdentifiers:R}=H(),l=class{constructor(e,r){if(r=Te(r),e instanceof l){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>_)throw new TypeError(`version is longer than ${_} characters`);$("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?W[V.LOOSE]:W[V.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>T||this.major<0)throw new TypeError("Invalid major version");if(this.minor>T||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>T||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let c=+o;if(c>=0&&c<T)return c}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if($("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if(typeof e=="string"&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),R(this.major,e.major)||R(this.minor,e.minor)||R(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=e.prerelease[r];if($("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return R(n,o)}while(++r)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let r=0;do{let n=this.build[r],o=e.build[r];if($("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return R(n,o)}while(++r)}inc(e,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r),this.inc("pre",r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r),this.inc("pre",r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let n=this.prerelease.length;for(;--n>=0;)typeof this.prerelease[n]=="number"&&(this.prerelease[n]++,n=-2);n===-1&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};z.exports=l});var ee=u((qe,Q)=>{var{MAX_LENGTH:we}=A(),{re:Y,t:J}=D(),K=Z(),Ce=G(),Pe=(i,e)=>{if(e=Ce(e),i instanceof K)return i;if(typeof i!="string"||i.length>we||!(e.loose?Y[J.LOOSE]:Y[J.FULL]).test(i))return null;try{return new K(i,e)}catch(n){return null}};Q.exports=Pe});var be={};he(be,{default:()=>Fe});var w=E(h("@yarnpkg/cli")),m=E(h("@yarnpkg/core")),p=E(h("clipanion"));function f(i=[]){let e=i.filter(r=>typeof r=="string");return console.info(e.join(" ")),e}var re=E(ee()),ke=(i=[])=>f(["npm","publish",...i]),g=class extends w.BaseCommand{constructor(){super(...arguments);this.tag=p.Option.String("--tag",null,{description:"The tag on the registry that the package should be attached to. '-C,--canary' will overwrite this parameter."});this.noTag=p.Option.Boolean("--no-tag",!1,{description:"Force a stable release regardless of version string."});this.tolerateRepublish=p.Option.Boolean("--tolerate-republish",!1,{description:"Warn and exit when republishing an already existing version of a package."});this.canary=p.Option.Boolean("-C,--canary",!1,{description:"Tag the release as 'canary'. The standard pre-release tag for @FuelRats projects."});this.all=p.Option.Boolean("-A,--all",!1,{description:"Publish all public repositories in the current project."});this.workspaces=p.Option.Rest()}async execute(){let e=await m.Configuration.find(this.context.cwd,this.context.plugins),{project:r,workspace:n}=await m.Project.find(e,this.context.cwd),o;if(this.all)o=r.workspaces.reduce((c,N)=>(N.manifest.private||c.push(N),c),[]);else if(this.workspaces.length>0){if(!n)throw new w.WorkspaceRequiredError(r.cwd,this.context.cwd);o=this.workspaces.map(c=>{let N=m.structUtils.parseIdent(c),v=r.getWorkspaceByIdent(N);if(v.manifest.private)throw new p.UsageError(`Workspace ${m.structUtils.prettyIdent(e,N)} is private and cannot be published. Aborting...`);return v})}if(!o||o.length===0)throw new p.UsageError("No list of workspaces were provided. Please supply at least one valid package name or '-A,--all'");for(let c of o)await this.cli.run(ke([this.getTagArg(c),this.tolerateRepublishArg]),{cwd:c.cwd})}getTagArg(e){var n;if(this.noTag)return null;let r=null;if(this.canary)r="canary";else if(this.tag)r=this.tag;else{let o=(0,re.default)(e.manifest.version,{includePrerelease:!0}),c=(n=o==null?void 0:o.prerelease)==null?void 0:n[0];typeof c=="string"&&(r=c)}return r?`--tag=${r}`:null}get tolerateRepublishArg(){return this.tolerateRepublish?"--tolerate-republish":null}};g.paths=[["workspaces","release"]],g.usage=p.Command.Usage({category:"Workspace-related commands",description:"Publish a list of workspaces in the project.",details:`
      This command will publish a list of packages, or optionally, all packages of a workspace.

      If a pre-release tag is detected for the package version, the package will be published under that tag instead of 'latest'.
    `});var te=g;var P=E(h("@yarnpkg/cli")),k=E(h("@yarnpkg/core")),d=E(h("clipanion"));var C=E(h("@yarnpkg/core")),se=E(h("clipanion"));function F(i,e){e.forEach(r=>{let n=`@yarnpkg/plugin-${r}`;if(!i.plugins.has(n)){let o=C.structUtils.prettyIdent(i,C.structUtils.parseIdent(n)),c=C.structUtils.prettyReference(i,`yarn plugin import ${r}`);throw new se.UsageError(`${o} is a required plugin. Please import it by using '${c}'`)}})}var ie=E(h("typanion")),ye=(i=[])=>f(["version","apply","--all",...i]),Se=(i=[])=>f(["version","--deferred",...i]),De=(i=[])=>f(["workspaces","foreach",...i]),b;(function(n){n.MAJOR="major",n.MINOR="minor",n.PATCH="patch"})(b||(b={}));var L=class extends P.BaseCommand{constructor(){super(...arguments);this.tag=d.Option.String("--tag",null,{description:"Tag the release with the given tag. '-C,--canary' will overwrite this parameter."});this.canary=d.Option.Boolean("-C,--canary",!1,{description:"Tag the version as 'canary'. The standard pre-release tag for @FuelRats projects."});this.strategy=d.Option.String({validator:ie.isEnum(b)})}async execute(){let e=await k.Configuration.find(this.context.cwd,this.context.plugins);F(e,["workspace-tools","version"]);let{project:r,workspace:n}=await k.Project.find(e,this.context.cwd);if(!n)throw new P.WorkspaceRequiredError(r.cwd,this.context.cwd);let o=Se([this.strategy[0]]);await this.cli.run(De(o)),await this.cli.run(o),await this.cli.run(ye([this.tagArg]))}get tagArg(){return this.canary?"--prerelease=canary.%n":this.tag?`--prerelease=${this.tag}.%n`:null}};L.paths=[["workspaces","version"]],L.usage=d.Command.Usage({category:"Workspace-related commands",description:"Update the project-wide fixed semver.",details:`
      This command will bump the version number of all workspaces in the project, then the project package itself.

      Use the \`-C,--canary\` flag to set the version to a canary release.
    `,examples:[["Bump the minor semver project-wide","yarn workspaces version minor"],["Bump the project-wide semver to a new minor-ver pre-release","yarn workspaces version minor --canary"]]});var ne=L;var Ge={commands:[ne,te]},Fe=Ge;return be;})();
return plugin;
}
};
